// *** WARNING: this file was generated by the Pulumi Terraform Bridge (tfgen) Tool. ***
// *** Do not edit by hand unless you're certain you know what you are doing! ***

package oci

import (
	"context"
	"reflect"

	"github.com/pkg/errors"
	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
)

// This resource provides the Protection Rule resource in Oracle Cloud Infrastructure Web Application Acceleration and Security service.
//
// Updates the action for each specified protection rule. Requests can either be allowed, blocked, or trigger an alert if they meet the parameters of an applied rule. For more information on protection rules, see [WAF Protection Rules](https://docs.cloud.oracle.com/iaas/Content/WAF/Tasks/wafprotectionrules.htm).
// This operation can update or disable protection rules depending on the structure of the request body.
// Protection rules can be updated by changing the properties of the protection rule object with the rule's key specified in the key field.
//
// ## Example Usage
//
// ```go
// package main
//
// import (
// 	"github.com/pulumi/pulumi-oci/sdk/go/oci"
// 	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
// )
//
// func main() {
// 	pulumi.Run(func(ctx *pulumi.Context) error {
// 		_, err := oci.NewWaasProtectionRule(ctx, "testProtectionRule", &oci.WaasProtectionRuleArgs{
// 			WaasPolicyId: pulumi.Any(oci_waas_waas_policy.Test_waas_policy.Id),
// 			Key:          pulumi.Any(_var.Key),
// 			Action:       pulumi.String("DETECT"),
// 			Exclusions: WaasProtectionRuleExclusionArray{
// 				Exclusions: WaasProtectionRuleExclusionArgs{
// 					"example.com",
// 				},
// 				Target: "REQUEST_COOKIES",
// 			},
// 		})
// 		if err != nil {
// 			return err
// 		}
// 		return nil
// 	})
// }
// ```
//
// ## Import
//
// ProtectionRules can be imported using the `id`, e.g.
//
// ```sh
//  $ pulumi import oci:index/waasProtectionRule:WaasProtectionRule test_protection_rule "waasPolicyId/{waasPolicyId}/key/{key}"
// ```
type WaasProtectionRule struct {
	pulumi.CustomResourceState

	// (Updatable) The action to take when the traffic is detected as malicious. If unspecified, defaults to `OFF`.
	Action pulumi.StringOutput `pulumi:"action"`
	// The description of the protection rule.
	Description pulumi.StringOutput `pulumi:"description"`
	// An array of The target property of a request that would allow it to bypass the protection rule. For example, when `target` is `REQUEST_COOKIE_NAMES`, the list may include names of cookies to exclude from the protection rule. When the target is `ARGS`, the list may include strings of URL query parameters and values from form-urlencoded XML, JSON, AMP, or POST payloads to exclude from the protection rule. `Exclusions` properties must not contain whitespace, comma or |. **Note:** If protection rules have been enabled that utilize the `maxArgumentCount` or `maxTotalNameLengthOfArguments` properties, and the `target` property has been set to `ARGS`, it is important that the `exclusions` properties be defined to honor those protection rule settings in a consistent manner.
	Exclusions WaasProtectionRuleExclusionArrayOutput `pulumi:"exclusions"`
	// (Updatable) The unique key of the protection rule.
	Key pulumi.StringOutput `pulumi:"key"`
	// The list of labels for the protection rule.
	Labels pulumi.StringArrayOutput `pulumi:"labels"`
	// The list of the ModSecurity rule IDs that apply to this protection rule. For more information about ModSecurity's open source WAF rules, see [Mod Security's documentation](https://www.modsecurity.org/CRS/Documentation/index.html).
	ModSecurityRuleIds pulumi.StringArrayOutput `pulumi:"modSecurityRuleIds"`
	// The name of the protection rule.
	Name pulumi.StringOutput `pulumi:"name"`
	// The [OCID](https://docs.cloud.oracle.com/iaas/Content/General/Concepts/identifiers.htm) of the WAAS policy.
	WaasPolicyId pulumi.StringOutput `pulumi:"waasPolicyId"`
}

// NewWaasProtectionRule registers a new resource with the given unique name, arguments, and options.
func NewWaasProtectionRule(ctx *pulumi.Context,
	name string, args *WaasProtectionRuleArgs, opts ...pulumi.ResourceOption) (*WaasProtectionRule, error) {
	if args == nil {
		return nil, errors.New("missing one or more required arguments")
	}

	if args.Key == nil {
		return nil, errors.New("invalid value for required argument 'Key'")
	}
	if args.WaasPolicyId == nil {
		return nil, errors.New("invalid value for required argument 'WaasPolicyId'")
	}
	var resource WaasProtectionRule
	err := ctx.RegisterResource("oci:index/waasProtectionRule:WaasProtectionRule", name, args, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// GetWaasProtectionRule gets an existing WaasProtectionRule resource's state with the given name, ID, and optional
// state properties that are used to uniquely qualify the lookup (nil if not required).
func GetWaasProtectionRule(ctx *pulumi.Context,
	name string, id pulumi.IDInput, state *WaasProtectionRuleState, opts ...pulumi.ResourceOption) (*WaasProtectionRule, error) {
	var resource WaasProtectionRule
	err := ctx.ReadResource("oci:index/waasProtectionRule:WaasProtectionRule", name, id, state, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// Input properties used for looking up and filtering WaasProtectionRule resources.
type waasProtectionRuleState struct {
	// (Updatable) The action to take when the traffic is detected as malicious. If unspecified, defaults to `OFF`.
	Action *string `pulumi:"action"`
	// The description of the protection rule.
	Description *string `pulumi:"description"`
	// An array of The target property of a request that would allow it to bypass the protection rule. For example, when `target` is `REQUEST_COOKIE_NAMES`, the list may include names of cookies to exclude from the protection rule. When the target is `ARGS`, the list may include strings of URL query parameters and values from form-urlencoded XML, JSON, AMP, or POST payloads to exclude from the protection rule. `Exclusions` properties must not contain whitespace, comma or |. **Note:** If protection rules have been enabled that utilize the `maxArgumentCount` or `maxTotalNameLengthOfArguments` properties, and the `target` property has been set to `ARGS`, it is important that the `exclusions` properties be defined to honor those protection rule settings in a consistent manner.
	Exclusions []WaasProtectionRuleExclusion `pulumi:"exclusions"`
	// (Updatable) The unique key of the protection rule.
	Key *string `pulumi:"key"`
	// The list of labels for the protection rule.
	Labels []string `pulumi:"labels"`
	// The list of the ModSecurity rule IDs that apply to this protection rule. For more information about ModSecurity's open source WAF rules, see [Mod Security's documentation](https://www.modsecurity.org/CRS/Documentation/index.html).
	ModSecurityRuleIds []string `pulumi:"modSecurityRuleIds"`
	// The name of the protection rule.
	Name *string `pulumi:"name"`
	// The [OCID](https://docs.cloud.oracle.com/iaas/Content/General/Concepts/identifiers.htm) of the WAAS policy.
	WaasPolicyId *string `pulumi:"waasPolicyId"`
}

type WaasProtectionRuleState struct {
	// (Updatable) The action to take when the traffic is detected as malicious. If unspecified, defaults to `OFF`.
	Action pulumi.StringPtrInput
	// The description of the protection rule.
	Description pulumi.StringPtrInput
	// An array of The target property of a request that would allow it to bypass the protection rule. For example, when `target` is `REQUEST_COOKIE_NAMES`, the list may include names of cookies to exclude from the protection rule. When the target is `ARGS`, the list may include strings of URL query parameters and values from form-urlencoded XML, JSON, AMP, or POST payloads to exclude from the protection rule. `Exclusions` properties must not contain whitespace, comma or |. **Note:** If protection rules have been enabled that utilize the `maxArgumentCount` or `maxTotalNameLengthOfArguments` properties, and the `target` property has been set to `ARGS`, it is important that the `exclusions` properties be defined to honor those protection rule settings in a consistent manner.
	Exclusions WaasProtectionRuleExclusionArrayInput
	// (Updatable) The unique key of the protection rule.
	Key pulumi.StringPtrInput
	// The list of labels for the protection rule.
	Labels pulumi.StringArrayInput
	// The list of the ModSecurity rule IDs that apply to this protection rule. For more information about ModSecurity's open source WAF rules, see [Mod Security's documentation](https://www.modsecurity.org/CRS/Documentation/index.html).
	ModSecurityRuleIds pulumi.StringArrayInput
	// The name of the protection rule.
	Name pulumi.StringPtrInput
	// The [OCID](https://docs.cloud.oracle.com/iaas/Content/General/Concepts/identifiers.htm) of the WAAS policy.
	WaasPolicyId pulumi.StringPtrInput
}

func (WaasProtectionRuleState) ElementType() reflect.Type {
	return reflect.TypeOf((*waasProtectionRuleState)(nil)).Elem()
}

type waasProtectionRuleArgs struct {
	// (Updatable) The action to take when the traffic is detected as malicious. If unspecified, defaults to `OFF`.
	Action *string `pulumi:"action"`
	// An array of The target property of a request that would allow it to bypass the protection rule. For example, when `target` is `REQUEST_COOKIE_NAMES`, the list may include names of cookies to exclude from the protection rule. When the target is `ARGS`, the list may include strings of URL query parameters and values from form-urlencoded XML, JSON, AMP, or POST payloads to exclude from the protection rule. `Exclusions` properties must not contain whitespace, comma or |. **Note:** If protection rules have been enabled that utilize the `maxArgumentCount` or `maxTotalNameLengthOfArguments` properties, and the `target` property has been set to `ARGS`, it is important that the `exclusions` properties be defined to honor those protection rule settings in a consistent manner.
	Exclusions []WaasProtectionRuleExclusion `pulumi:"exclusions"`
	// (Updatable) The unique key of the protection rule.
	Key string `pulumi:"key"`
	// The [OCID](https://docs.cloud.oracle.com/iaas/Content/General/Concepts/identifiers.htm) of the WAAS policy.
	WaasPolicyId string `pulumi:"waasPolicyId"`
}

// The set of arguments for constructing a WaasProtectionRule resource.
type WaasProtectionRuleArgs struct {
	// (Updatable) The action to take when the traffic is detected as malicious. If unspecified, defaults to `OFF`.
	Action pulumi.StringPtrInput
	// An array of The target property of a request that would allow it to bypass the protection rule. For example, when `target` is `REQUEST_COOKIE_NAMES`, the list may include names of cookies to exclude from the protection rule. When the target is `ARGS`, the list may include strings of URL query parameters and values from form-urlencoded XML, JSON, AMP, or POST payloads to exclude from the protection rule. `Exclusions` properties must not contain whitespace, comma or |. **Note:** If protection rules have been enabled that utilize the `maxArgumentCount` or `maxTotalNameLengthOfArguments` properties, and the `target` property has been set to `ARGS`, it is important that the `exclusions` properties be defined to honor those protection rule settings in a consistent manner.
	Exclusions WaasProtectionRuleExclusionArrayInput
	// (Updatable) The unique key of the protection rule.
	Key pulumi.StringInput
	// The [OCID](https://docs.cloud.oracle.com/iaas/Content/General/Concepts/identifiers.htm) of the WAAS policy.
	WaasPolicyId pulumi.StringInput
}

func (WaasProtectionRuleArgs) ElementType() reflect.Type {
	return reflect.TypeOf((*waasProtectionRuleArgs)(nil)).Elem()
}

type WaasProtectionRuleInput interface {
	pulumi.Input

	ToWaasProtectionRuleOutput() WaasProtectionRuleOutput
	ToWaasProtectionRuleOutputWithContext(ctx context.Context) WaasProtectionRuleOutput
}

func (*WaasProtectionRule) ElementType() reflect.Type {
	return reflect.TypeOf((*WaasProtectionRule)(nil))
}

func (i *WaasProtectionRule) ToWaasProtectionRuleOutput() WaasProtectionRuleOutput {
	return i.ToWaasProtectionRuleOutputWithContext(context.Background())
}

func (i *WaasProtectionRule) ToWaasProtectionRuleOutputWithContext(ctx context.Context) WaasProtectionRuleOutput {
	return pulumi.ToOutputWithContext(ctx, i).(WaasProtectionRuleOutput)
}

func (i *WaasProtectionRule) ToWaasProtectionRulePtrOutput() WaasProtectionRulePtrOutput {
	return i.ToWaasProtectionRulePtrOutputWithContext(context.Background())
}

func (i *WaasProtectionRule) ToWaasProtectionRulePtrOutputWithContext(ctx context.Context) WaasProtectionRulePtrOutput {
	return pulumi.ToOutputWithContext(ctx, i).(WaasProtectionRulePtrOutput)
}

type WaasProtectionRulePtrInput interface {
	pulumi.Input

	ToWaasProtectionRulePtrOutput() WaasProtectionRulePtrOutput
	ToWaasProtectionRulePtrOutputWithContext(ctx context.Context) WaasProtectionRulePtrOutput
}

type waasProtectionRulePtrType WaasProtectionRuleArgs

func (*waasProtectionRulePtrType) ElementType() reflect.Type {
	return reflect.TypeOf((**WaasProtectionRule)(nil))
}

func (i *waasProtectionRulePtrType) ToWaasProtectionRulePtrOutput() WaasProtectionRulePtrOutput {
	return i.ToWaasProtectionRulePtrOutputWithContext(context.Background())
}

func (i *waasProtectionRulePtrType) ToWaasProtectionRulePtrOutputWithContext(ctx context.Context) WaasProtectionRulePtrOutput {
	return pulumi.ToOutputWithContext(ctx, i).(WaasProtectionRulePtrOutput)
}

// WaasProtectionRuleArrayInput is an input type that accepts WaasProtectionRuleArray and WaasProtectionRuleArrayOutput values.
// You can construct a concrete instance of `WaasProtectionRuleArrayInput` via:
//
//          WaasProtectionRuleArray{ WaasProtectionRuleArgs{...} }
type WaasProtectionRuleArrayInput interface {
	pulumi.Input

	ToWaasProtectionRuleArrayOutput() WaasProtectionRuleArrayOutput
	ToWaasProtectionRuleArrayOutputWithContext(context.Context) WaasProtectionRuleArrayOutput
}

type WaasProtectionRuleArray []WaasProtectionRuleInput

func (WaasProtectionRuleArray) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*WaasProtectionRule)(nil)).Elem()
}

func (i WaasProtectionRuleArray) ToWaasProtectionRuleArrayOutput() WaasProtectionRuleArrayOutput {
	return i.ToWaasProtectionRuleArrayOutputWithContext(context.Background())
}

func (i WaasProtectionRuleArray) ToWaasProtectionRuleArrayOutputWithContext(ctx context.Context) WaasProtectionRuleArrayOutput {
	return pulumi.ToOutputWithContext(ctx, i).(WaasProtectionRuleArrayOutput)
}

// WaasProtectionRuleMapInput is an input type that accepts WaasProtectionRuleMap and WaasProtectionRuleMapOutput values.
// You can construct a concrete instance of `WaasProtectionRuleMapInput` via:
//
//          WaasProtectionRuleMap{ "key": WaasProtectionRuleArgs{...} }
type WaasProtectionRuleMapInput interface {
	pulumi.Input

	ToWaasProtectionRuleMapOutput() WaasProtectionRuleMapOutput
	ToWaasProtectionRuleMapOutputWithContext(context.Context) WaasProtectionRuleMapOutput
}

type WaasProtectionRuleMap map[string]WaasProtectionRuleInput

func (WaasProtectionRuleMap) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*WaasProtectionRule)(nil)).Elem()
}

func (i WaasProtectionRuleMap) ToWaasProtectionRuleMapOutput() WaasProtectionRuleMapOutput {
	return i.ToWaasProtectionRuleMapOutputWithContext(context.Background())
}

func (i WaasProtectionRuleMap) ToWaasProtectionRuleMapOutputWithContext(ctx context.Context) WaasProtectionRuleMapOutput {
	return pulumi.ToOutputWithContext(ctx, i).(WaasProtectionRuleMapOutput)
}

type WaasProtectionRuleOutput struct {
	*pulumi.OutputState
}

func (WaasProtectionRuleOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*WaasProtectionRule)(nil))
}

func (o WaasProtectionRuleOutput) ToWaasProtectionRuleOutput() WaasProtectionRuleOutput {
	return o
}

func (o WaasProtectionRuleOutput) ToWaasProtectionRuleOutputWithContext(ctx context.Context) WaasProtectionRuleOutput {
	return o
}

func (o WaasProtectionRuleOutput) ToWaasProtectionRulePtrOutput() WaasProtectionRulePtrOutput {
	return o.ToWaasProtectionRulePtrOutputWithContext(context.Background())
}

func (o WaasProtectionRuleOutput) ToWaasProtectionRulePtrOutputWithContext(ctx context.Context) WaasProtectionRulePtrOutput {
	return o.ApplyT(func(v WaasProtectionRule) *WaasProtectionRule {
		return &v
	}).(WaasProtectionRulePtrOutput)
}

type WaasProtectionRulePtrOutput struct {
	*pulumi.OutputState
}

func (WaasProtectionRulePtrOutput) ElementType() reflect.Type {
	return reflect.TypeOf((**WaasProtectionRule)(nil))
}

func (o WaasProtectionRulePtrOutput) ToWaasProtectionRulePtrOutput() WaasProtectionRulePtrOutput {
	return o
}

func (o WaasProtectionRulePtrOutput) ToWaasProtectionRulePtrOutputWithContext(ctx context.Context) WaasProtectionRulePtrOutput {
	return o
}

type WaasProtectionRuleArrayOutput struct{ *pulumi.OutputState }

func (WaasProtectionRuleArrayOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*[]WaasProtectionRule)(nil))
}

func (o WaasProtectionRuleArrayOutput) ToWaasProtectionRuleArrayOutput() WaasProtectionRuleArrayOutput {
	return o
}

func (o WaasProtectionRuleArrayOutput) ToWaasProtectionRuleArrayOutputWithContext(ctx context.Context) WaasProtectionRuleArrayOutput {
	return o
}

func (o WaasProtectionRuleArrayOutput) Index(i pulumi.IntInput) WaasProtectionRuleOutput {
	return pulumi.All(o, i).ApplyT(func(vs []interface{}) WaasProtectionRule {
		return vs[0].([]WaasProtectionRule)[vs[1].(int)]
	}).(WaasProtectionRuleOutput)
}

type WaasProtectionRuleMapOutput struct{ *pulumi.OutputState }

func (WaasProtectionRuleMapOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]WaasProtectionRule)(nil))
}

func (o WaasProtectionRuleMapOutput) ToWaasProtectionRuleMapOutput() WaasProtectionRuleMapOutput {
	return o
}

func (o WaasProtectionRuleMapOutput) ToWaasProtectionRuleMapOutputWithContext(ctx context.Context) WaasProtectionRuleMapOutput {
	return o
}

func (o WaasProtectionRuleMapOutput) MapIndex(k pulumi.StringInput) WaasProtectionRuleOutput {
	return pulumi.All(o, k).ApplyT(func(vs []interface{}) WaasProtectionRule {
		return vs[0].(map[string]WaasProtectionRule)[vs[1].(string)]
	}).(WaasProtectionRuleOutput)
}

func init() {
	pulumi.RegisterOutputType(WaasProtectionRuleOutput{})
	pulumi.RegisterOutputType(WaasProtectionRulePtrOutput{})
	pulumi.RegisterOutputType(WaasProtectionRuleArrayOutput{})
	pulumi.RegisterOutputType(WaasProtectionRuleMapOutput{})
}
